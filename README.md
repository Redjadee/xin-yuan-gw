# å¹¿å¤–ä¿¡é™¢æ ¡å‹ä¹‹å®¶ (XYGW)

> å¹¿å¤–äººè¦å®ˆæŠ¤ä¸€è¾ˆå­çš„å°ç¨‹åºğŸ«¡

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [é¡¹ç›®ç»“æ„è¯¦è§£](#é¡¹ç›®ç»“æ„è¯¦è§£)
- [API æ¥å£ç®¡ç†](#api-æ¥å£ç®¡ç†)
- [çŠ¶æ€ç®¡ç†](#çŠ¶æ€ç®¡ç†)
- [å…³é”®é¡µé¢è¯´æ˜](#å…³é”®é¡µé¢è¯´æ˜)
- [æ„å»ºé…ç½®è¯´æ˜](#æ„å»ºé…ç½®è¯´æ˜)
- [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº Taro æ¡†æ¶å¼€å‘çš„è·¨ç«¯æ ¡å‹ç¤¾äº¤å°ç¨‹åºï¼Œä¸»è¦æœåŠ¡äºå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ä¿¡æ¯ç§‘å­¦æŠ€æœ¯å­¦é™¢çš„æ ¡å‹ã€‚é¡¹ç›®æ”¯æŒå¤šå¹³å°ç¼–è¯‘è¿è¡Œï¼š

- å¾®ä¿¡å°ç¨‹åºï¼ˆä¸»è¦å¹³å°ï¼‰
- H5 ç½‘é¡µç‰ˆ
- æ”¯ä»˜å®å°ç¨‹åº
- ç™¾åº¦æ™ºèƒ½å°ç¨‹åº
- å­—èŠ‚è·³åŠ¨å°ç¨‹åº
- QQ å°ç¨‹åº

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- æ ¡å‹ç»„ç»‡ç®¡ç†
- æ´»åŠ¨å‘å¸ƒä¸æŠ¥å
- é€šè®¯å½•ï¼ˆæ”¯æŒæŒ‰å¹´çº§ã€ç»„ç»‡åˆ†ç±»ï¼‰
- æ¶ˆæ¯ç³»ç»Ÿ
- ä¸ªäººèµ„æ–™ç®¡ç†
- ç®¡ç†å‘˜åå°ï¼ˆæ´»åŠ¨å®¡æ ¸ã€ç»„ç»‡ç®¡ç†ç­‰ï¼‰

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **Taro 4.1.5** - å¤šç«¯ç»Ÿä¸€å¼€å‘æ¡†æ¶
- **React 18** - UI åº“
- **TypeScript 5.4.5** - ç±»å‹ç³»ç»Ÿ

### çŠ¶æ€ç®¡ç†
- **Redux Toolkit 2.8.2** - çŠ¶æ€ç®¡ç†
- **Redux Persist 6.0.0** - æŒä¹…åŒ–çŠ¶æ€

### UI ç»„ä»¶
- **@taroify/core 0.9.0** - Taro ç‰ˆ Vant ç»„ä»¶åº“
- **@vant/weapp 1.11.7** - Vant å¾®ä¿¡å°ç¨‹åºç»„ä»¶

### å·¥å…·åº“
- **Axios 1.11.0** - HTTP å®¢æˆ·ç«¯
- **dayjs 1.11.18** - æ—¥æœŸå¤„ç†
- **js-sha1 0.7.0** - SHA1 åŠ å¯†
- **js-base64 3.7.8** - Base64 ç¼–è§£ç 

### æ„å»ºå·¥å…·
- **Webpack 5** - æ¨¡å—æ‰“åŒ…
- **Sass 1.75.0** - CSS é¢„å¤„ç†å™¨
- **Terser** - ä»£ç å‹ç¼©æ··æ·†

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18
- npm >= 8

### å®‰è£…ä¾èµ–
```bash
npm install
```

### å¼€å‘æ¨¡å¼

```bash
# å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼ˆæœ€å¸¸ç”¨ï¼‰
npm run dev:weapp

# H5 å¼€å‘
npm run dev:h5

# å…¶ä»–å¹³å°
npm run dev:alipay   # æ”¯ä»˜å®
npm run dev:swan     # ç™¾åº¦
npm run dev:tt       # å­—èŠ‚è·³åŠ¨
npm run dev:qq       # QQ
```

### ç”Ÿäº§æ„å»º

```bash
# å¾®ä¿¡å°ç¨‹åºæ„å»º
npm run build:weapp

# H5 æ„å»º
npm run build:h5

# å…¶ä»–å¹³å°
npm run build:alipay
npm run build:swan
npm run build:tt
npm run build:qq
```

### åˆ›å»ºæ–°é¡µé¢/ç»„ä»¶
```bash
npm run new
```

---

## ç¯å¢ƒé…ç½®

é¡¹ç›®æ”¯æŒä¸‰ä¸ªç¯å¢ƒï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æ–‡ä»¶ç®¡ç†é…ç½®ï¼š

### 1. å¼€å‘ç¯å¢ƒ (`.env.development`)
```env
TARO_APP_API="https://xygdufs.298686.xyz:38888"
TARO_APP_IMG_API="https://html.xygdufs.298686.xyz"
```

### 2. æµ‹è¯•ç¯å¢ƒ (`.env.test`)
```env
# TARO_APP_ID="æµ‹è¯•ç¯å¢ƒä¸‹çš„å°ç¨‹åº AppID"
```

### 3. ç”Ÿäº§ç¯å¢ƒ (`.env.production`)
```env
TARO_APP_API="https://api.x.xygdufs.cn"
TARO_APP_IMG_API="https://html.x.xygdufs.cn"
```

### ç¯å¢ƒå˜é‡è¯´æ˜
- `TARO_APP_API` - åç«¯ API åŸºç¡€åœ°å€
- `TARO_APP_IMG_API` - å›¾ç‰‡èµ„æºæœåŠ¡å™¨åœ°å€
- `TARO_APP_ID` - å°ç¨‹åº AppIDï¼ˆå¯é€‰ï¼‰

### åˆ‡æ¢ç¯å¢ƒ
Taro ä¼šæ ¹æ® `process.env.NODE_ENV` è‡ªåŠ¨åŠ è½½å¯¹åº”çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š
- `npm run dev:*` â†’ åŠ è½½ `.env.development`
- `npm run build:*` â†’ åŠ è½½ `.env.production`

---

## é¡¹ç›®ç»“æ„è¯¦è§£

```
xygw/
â”œâ”€â”€ config/                    # Taro æ„å»ºé…ç½®
â”‚   â”œâ”€â”€ index.ts              # åŸºç¡€é…ç½®ï¼ˆwebpackã€åˆ†åŒ…ç­–ç•¥ï¼‰
â”‚   â”œâ”€â”€ dev.ts                # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ prod.ts               # ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆå‹ç¼©ã€ä¼˜åŒ–ï¼‰
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.config.ts         # å…¨å±€é…ç½®ï¼ˆé¡µé¢è·¯ç”±ã€tabBarã€åˆ†åŒ…ï¼‰
â”‚   â”œâ”€â”€ app.scss              # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ store/                # Redux çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ index.ts          # Store é…ç½®
â”‚   â”‚   â”œâ”€â”€ authSlice.ts      # è®¤è¯çŠ¶æ€ï¼ˆç™»å½•ã€tokenã€éªŒè¯ï¼‰
â”‚   â”‚   â””â”€â”€ tabBarSlice.ts    # åº•éƒ¨å¯¼èˆªæ çŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ custom-tab-bar/       # è‡ªå®šä¹‰ TabBar
â”‚   â”‚   â”œâ”€â”€ index.tsx         # TabBar ç»„ä»¶ï¼ˆå«ç™»å½•æ‹¦æˆªï¼‰
â”‚   â”‚   â””â”€â”€ index.scss
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                # ä¸»åŒ…é¡µé¢ï¼ˆTabBar é¡µé¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ index/            # é¦–é¡µï¼ˆæ´»åŠ¨æµï¼‰
â”‚   â”‚   â”œâ”€â”€ alumnus/          # æ ¡å‹ç»„ç»‡
â”‚   â”‚   â””â”€â”€ my/               # æˆ‘çš„
â”‚   â”‚
â”‚   â”œâ”€â”€ global/               # å…¨å±€èµ„æº
â”‚   â”‚   â”œâ”€â”€ components/       # å…¨å±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SearchTab/    # æœç´¢æ ‡ç­¾é¡µç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Textarea/     # å¢å¼ºç‰ˆæ–‡æœ¬åŸŸ
â”‚   â”‚   â”‚   â””â”€â”€ VoidHint/     # ç©ºçŠ¶æ€æç¤ºç»„ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ assets/           # é™æ€èµ„æº
â”‚   â”‚   â”‚   â””â”€â”€ images/       # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ api/          # API æ¥å£ï¼ˆæŒ‰åç«¯æ–‡æ¡£é¡ºåºç»„ç»‡ï¼‰
â”‚   â”‚       â”‚   â”œâ”€â”€ request.ts           # Axios å®ä¾‹ï¼ˆæ‹¦æˆªå™¨ï¼‰
â”‚   â”‚       â”‚   â”œâ”€â”€ AbortController.ts   # è¯·æ±‚å–æ¶ˆæ§åˆ¶å™¨
â”‚   â”‚       â”‚   â”œâ”€â”€ usercenter/          # ç”¨æˆ·ä¸­å¿ƒæ¥å£
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ base.ts          # åŸºç¡€æ¥å£ï¼ˆç™»å½•ã€æ³¨å†Œï¼‰
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ user.ts          # ç”¨æˆ·ä¿¡æ¯æ¥å£
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ friend.ts        # å¥½å‹æ¥å£
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ message.ts       # æ¶ˆæ¯æ¥å£
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ fileupload.ts    # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ admin/           # ç®¡ç†å‘˜æ¥å£
â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ alumni.ts
â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ audit.ts
â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ data.ts
â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ message.ts
â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ permission.ts
â”‚   â”‚       â”‚   â”‚       â””â”€â”€ org.ts
â”‚   â”‚       â”‚   â””â”€â”€ activitycenter/      # æ´»åŠ¨ä¸­å¿ƒæ¥å£
â”‚   â”‚       â”‚       â”œâ”€â”€ activity.ts
â”‚   â”‚       â”‚       â””â”€â”€ org.ts
â”‚   â”‚       â””â”€â”€ common.ts                # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”‚
â”‚   â”œâ”€â”€ loginPkg/             # ç™»å½•åˆ†åŒ…
â”‚   â”‚   â””â”€â”€ pages/
â”‚   â”‚       â”œâ”€â”€ login/        # ç™»å½•é¡µ
â”‚   â”‚       â”œâ”€â”€ register/     # æ³¨å†Œé¡µ
â”‚   â”‚       â”œâ”€â”€ forgot/       # å¿˜è®°å¯†ç 
â”‚   â”‚       â””â”€â”€ reset/        # é‡ç½®å¯†ç 
â”‚   â”‚
â”‚   â”œâ”€â”€ activityPkg/          # æ´»åŠ¨åˆ†åŒ…
â”‚   â”‚   â””â”€â”€ pages/
â”‚   â”‚       â”œâ”€â”€ allview/      # æ´»åŠ¨åˆ—è¡¨
â”‚   â”‚       â””â”€â”€ detail/       # æ´»åŠ¨è¯¦æƒ…
â”‚   â”‚
â”‚   â”œâ”€â”€ myPkg/                # ä¸ªäººä¸­å¿ƒåˆ†åŒ…
â”‚   â”‚   â”œâ”€â”€ components/       # åˆ†åŒ…ä¸“ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ContactItem/  # è”ç³»äººé¡¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ pages/
â”‚   â”‚       â”œâ”€â”€ contact/      # é€šè®¯å½•ï¼ˆé‡ç‚¹é¡µé¢ï¼‰
â”‚   â”‚       â”œâ”€â”€ setting/      # è®¾ç½®
â”‚   â”‚       â”œâ”€â”€ myinfor/      # ä¸ªäººä¿¡æ¯
â”‚   â”‚       â””â”€â”€ settingdetail/# è®¾ç½®è¯¦æƒ…
â”‚   â”‚
â”‚   â”œâ”€â”€ msgPkg/               # æ¶ˆæ¯åˆ†åŒ…
â”‚   â”‚   â””â”€â”€ pages/
â”‚   â”‚       â”œâ”€â”€ allmsg/       # æ¶ˆæ¯åˆ—è¡¨
â”‚   â”‚       â”œâ”€â”€ chat/         # èŠå¤©é¡µ
â”‚   â”‚       â””â”€â”€ infor/        # æ¶ˆæ¯è¯¦æƒ…
â”‚   â”‚
â”‚   â””â”€â”€ adminPkg/             # ç®¡ç†å‘˜åˆ†åŒ…
â”‚       â””â”€â”€ pages/
â”‚           â”œâ”€â”€ home/         # ç®¡ç†å‘˜é¦–é¡µ
â”‚           â”œâ”€â”€ setting/      # ç®¡ç†è®¾ç½®
â”‚           â”œâ”€â”€ import/       # å¯¼å…¥æ•°æ®
â”‚           â”œâ”€â”€ newActivi/    # æ–°å»ºæ´»åŠ¨
â”‚           â”œâ”€â”€ adminManage/  # ç®¡ç†å‘˜ç®¡ç†
â”‚           â”œâ”€â”€ organizationNaudit/  # ç»„ç»‡å®¡æ ¸
â”‚           â”œâ”€â”€ newOrgan/     # æ–°å»ºç»„ç»‡
â”‚           â”œâ”€â”€ auditDetail/  # å®¡æ ¸è¯¦æƒ…
â”‚           â””â”€â”€ newNotification/     # æ–°å»ºé€šçŸ¥
â”‚
â”œâ”€â”€ .env.development          # å¼€å‘ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.test                 # æµ‹è¯•ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.production           # ç”Ÿäº§ç¯å¢ƒå˜é‡
â”œâ”€â”€ project.config.json       # å¾®ä¿¡å°ç¨‹åºé…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## API æ¥å£ç®¡ç†

### æ¥å£æ–‡ä»¶ç»„ç»‡åŸåˆ™

**é‡è¦è¯´æ˜ï¼š** API æ¥å£æ–‡ä»¶ä¸¥æ ¼æŒ‰ç…§åç«¯æ¥å£æ–‡æ¡£çš„é¡ºåºç»„ç»‡ï¼Œæ–¹ä¾¿æŸ¥æ‰¾å’Œç»´æŠ¤ã€‚

### æ–‡ä»¶ç»“æ„
```
src/global/utils/api/
â”œâ”€â”€ request.ts                # Axios é…ç½®ï¼ˆæ‹¦æˆªå™¨ã€token æ³¨å…¥ï¼‰
â”œâ”€â”€ AbortController.ts        # è¯·æ±‚å–æ¶ˆæ§åˆ¶å™¨
â”‚
â”œâ”€â”€ usercenter/               # ç”¨æˆ·ä¸­å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ base.ts              # åŸºç¡€æ¥å£ï¼ˆç™»å½•ã€æ³¨å†Œã€éªŒè¯ç ï¼‰
â”‚   â”œâ”€â”€ user.ts              # ç”¨æˆ·ä¿¡æ¯ç›¸å…³
â”‚   â”œâ”€â”€ friend.ts            # å¥½å‹/é€šè®¯å½•ç›¸å…³
â”‚   â”œâ”€â”€ message.ts           # æ¶ˆæ¯ç›¸å…³
â”‚   â”œâ”€â”€ fileupload.ts        # æ–‡ä»¶ä¸Šä¼ 
â”‚   â””â”€â”€ admin/               # ç®¡ç†å‘˜æ¥å£
â”‚       â”œâ”€â”€ alumni.ts        # æ ¡å‹ç®¡ç†
â”‚       â”œâ”€â”€ audit.ts         # å®¡æ ¸ç®¡ç†
â”‚       â”œâ”€â”€ data.ts          # æ•°æ®ç®¡ç†
â”‚       â”œâ”€â”€ message.ts       # æ¶ˆæ¯ç®¡ç†
â”‚       â”œâ”€â”€ permission.ts    # æƒé™ç®¡ç†
â”‚       â””â”€â”€ org.ts           # ç»„ç»‡ç®¡ç†
â”‚
â””â”€â”€ activitycenter/           # æ´»åŠ¨ä¸­å¿ƒæ¨¡å—
    â”œâ”€â”€ activity.ts          # æ´»åŠ¨ç›¸å…³
    â””â”€â”€ org.ts               # ç»„ç»‡ç›¸å…³
```

### è¯·æ±‚å–æ¶ˆæ§åˆ¶

æ‰€æœ‰ API å‡½æ•°éƒ½æ”¯æŒä¼ å…¥ `AbortSignal`ï¼Œç”¨äºåœ¨ç»„ä»¶å¸è½½æ—¶å–æ¶ˆè¯·æ±‚ï¼š

```typescript
useEffect(() => {
  const controller = new AbortController()

  const fetchData = async () => {
    const res = await someAPI(controller.signal)
    // ...
  }
  fetchData()

  return () => controller.abort()  // æ¸…ç†æ—¶å–æ¶ˆè¯·æ±‚
}, [])
```

---

## çŠ¶æ€ç®¡ç†

### Redux Store ç»“æ„

```typescript
{
  auth: {
    isLogged: boolean,     // æ˜¯å¦å·²ç™»å½•
    isVerified: boolean,   // æ˜¯å¦å·²å®Œæˆä¿¡æ¯éªŒè¯
    token: string | null   // JWT token
  },
  tabBar: {
    value: number,         // å½“å‰é€‰ä¸­çš„ tab ç´¢å¼•
    visible: boolean       // tabBar æ˜¯å¦å¯è§
  }
}
```

### è®¤è¯çŠ¶æ€ç®¡ç† (`authSlice.ts`)

#### çŠ¶æ€å­—æ®µè¯´æ˜
- `isLogged`: ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼ˆæœ‰ tokenï¼‰
- `isVerified`: ç”¨æˆ·æ˜¯å¦å·²å®Œæˆä¿¡æ¯éªŒè¯ï¼ˆæ³¨å†Œåéœ€éªŒè¯å­¦å·ç­‰ï¼‰
- `token`: JWT tokenï¼Œç”¨äº API è¯·æ±‚é‰´æƒ

#### Actions
```typescript
import { loginSuccess, verifySuccess, logout } from '@/store/authSlice'

// ç™»å½•æˆåŠŸ
dispatch(loginSuccess({ token: 'xxx' }))
// â†’ isLogged: true, isVerified: false

// éªŒè¯æˆåŠŸï¼ˆå®Œæˆæ³¨å†Œæµç¨‹ï¼‰
dispatch(verifySuccess())
// â†’ isLogged: true, isVerified: true

// ç™»å‡º
dispatch(logout())
// â†’ æ¸…ç©ºæ‰€æœ‰çŠ¶æ€
```

#### ç™»å½•æµç¨‹
1. ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç  â†’ è°ƒç”¨ç™»å½• API
2. ç™»å½•æˆåŠŸ â†’ `dispatch(loginSuccess({ token }))`
3. å¦‚æœæ˜¯æ–°ç”¨æˆ· â†’ è·³è½¬ä¿¡æ¯éªŒè¯é¡µé¢
4. éªŒè¯å®Œæˆ â†’ `dispatch(verifySuccess())`
5. è·³è½¬ä¸»é¡µ

### TabBar çŠ¶æ€ç®¡ç† (`tabBarSlice.ts`)

```typescript
import { setTabBar, hideTabBar, showTabBar } from '@/store/tabBarSlice'

// åˆ‡æ¢ tab
dispatch(setTabBar(1))  // åˆ‡æ¢åˆ°ç´¢å¼• 1 çš„ tab

// éšè— TabBarï¼ˆè¿›å…¥äºŒçº§é¡µé¢ï¼‰
dispatch(hideTabBar())

// æ˜¾ç¤º TabBar
dispatch(showTabBar())
```

---

## å…³é”®é¡µé¢è¯´æ˜

### 1. é€šè®¯å½•é¡µé¢ (`myPkg/pages/contact/index.tsx`)

å®ç°äº†å¤šå±‚çº§è”åŠ¨å’Œå­—æ¯ç´¢å¼•åŠŸèƒ½ã€‚è¯¦ç»†çš„å˜é‡è¯´æ˜å’Œé€»è¾‘è§£é‡Šè¯·æŸ¥çœ‹é¡µé¢æ–‡ä»¶é¡¶éƒ¨çš„æ³¨é‡Šã€‚

**é¡µé¢å‚æ•°ï¼š**
- `type` - é€šè®¯å½•ç±»å‹ï¼ˆ'0': æ ¡å‹é€šè®¯å½•, '1': ç»„ç»‡é€šè®¯å½•, å…¶ä»–: ä»–äººç»„ç»‡ï¼‰
- `id` - ç»„ç»‡/ç”¨æˆ· IDï¼ˆtype ä¸º '1' æˆ–å…¶ä»–æ—¶éœ€è¦ï¼‰

---

### 2. è‡ªå®šä¹‰ TabBar (`custom-tab-bar/index.tsx`)

**ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰ï¼š**
- åˆ‡æ¢ tab å‰æ£€æŸ¥ç™»å½•çŠ¶æ€
- åˆ‡æ¢ tab å‰æ£€æŸ¥ä¿¡æ¯éªŒè¯çŠ¶æ€
- åŠ¨æ€æ˜¾ç¤º/éšè— TabBar

**æ ¸å¿ƒåŠŸèƒ½ï¼š** åœ¨ `switchTab()` æ–¹æ³•ä¸­å®ç°ç™»å½•æ‹¦æˆªï¼Œæœªç™»å½•è·³è½¬ç™»å½•é¡µï¼Œå·²ç™»å½•ä½†æœªéªŒè¯è·³è½¬ä¿¡æ¯éªŒè¯é¡µã€‚

---

### 3. æ´»åŠ¨åˆ—è¡¨é¡µ (`activityPkg/pages/allview`)

**é¡µé¢å‚æ•°ï¼š**
- `type` - æ´»åŠ¨åˆ—è¡¨ç±»å‹ï¼ˆ'0': å…¨éƒ¨, '1': æˆ‘çš„, '2': ç®¡ç†ç«¯, '3': ä»–äººçš„, '4': ç»„ç»‡çš„ï¼‰
- `id` - ç”¨æˆ·/ç»„ç»‡ IDï¼ˆtype ä¸º '3' æˆ– '4' æ—¶éœ€è¦ï¼‰

---

### 4. å…¶ä»–é‡è¦é¡µé¢

æ‰€æœ‰é¡µé¢çš„ URL å‚æ•°è¯´æ˜éƒ½å·²åœ¨å¯¹åº”çš„é¡µé¢æ–‡ä»¶é¡¶éƒ¨æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼ŒåŒ…æ‹¬ï¼š
- **ä¿¡æ¯é¡µ** (`msgPkg/pages/infor`) - ä¸ªäºº/ç»„ç»‡ä¿¡æ¯å±•ç¤º
- **èŠå¤©é¡µ** (`msgPkg/pages/chat`) - æ¶ˆæ¯èŠå¤©
- **æ³¨å†Œé¡µ** (`loginPkg/pages/register`) - æ³¨å†Œ/èº«ä»½è®¤è¯
- **å¿˜è®°å¯†ç é¡µ** (`loginPkg/pages/forgot`) - æ‰¾å›å¯†ç /äººå·¥ç”³è¯‰
- **é‡ç½®å¯†ç é¡µ** (`loginPkg/pages/reset`) - é‡ç½®/ä¿®æ”¹å¯†ç 

---

## æ„å»ºé…ç½®è¯´æ˜

é¡¹ç›®ç»è¿‡å¤§é‡æ„å»ºä¼˜åŒ–ä»¥è§£å†³å°ç¨‹åºä¸»åŒ…ä½“ç§¯é™åˆ¶é—®é¢˜ã€‚

### æ ¸å¿ƒé…ç½®

- **è®¾è®¡ç¨¿å®½åº¦**ï¼š375pxï¼ˆè‡ªåŠ¨è½¬æ¢ px ä¸º rpx/remï¼‰
- **åˆ†åŒ…é¢„ä¸‹è½½**ï¼šè¿›å…¥ä¸»è¦é¡µé¢æ—¶è‡ªåŠ¨é¢„ä¸‹è½½ç›¸å…³åˆ†åŒ…
- **Webpack ä¼˜åŒ–**ï¼šé»‘åå•ç­–ç•¥è¸¢å‡ºå¤§ä½“ç§¯åº“ï¼Œå…è®¸åˆ†åŒ…å†—ä½™ä»¥å‡å°‘ä¸»åŒ…ä½“ç§¯
- **ä»£ç å‹ç¼©**ï¼šä¿ç•™ç±»åå’Œå‡½æ•°åï¼ˆTaro éœ€è¦ï¼‰ï¼Œç§»é™¤ console å’Œ debugger

### è¯¦ç»†é…ç½®æ–‡æ¡£

æ‰€æœ‰æ„å»ºé…ç½®çš„è¯¦ç»†è¯´æ˜å’ŒåŸç†è§£æè¯·æŸ¥çœ‹ï¼š
- **`config/index.ts`** - åŒ…å«å®Œæ•´çš„åˆ†åŒ…ç­–ç•¥ã€Webpack é…ç½®ã€ä¼˜åŒ–æ–¹æ¡ˆç­‰è¯¦ç»†æ³¨é‡Š
- **`config/prod.ts`** - ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆä»£ç å‹ç¼©ã€ä¼˜åŒ–ï¼‰
- **`config/dev.ts`** - å¼€å‘ç¯å¢ƒé…ç½®

---

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

#### ç»„ä»¶ç¼–å†™
```typescript
// å‡½æ•°ç»„ä»¶ï¼ˆæ¨èï¼‰
export default function MyComponent() {
  return <View>...</View>
}

// ç±»ç»„ä»¶ï¼ˆä»…ç‰¹æ®Šåœºæ™¯ä½¿ç”¨ï¼Œå¦‚ TabBarï¼‰
class MyComponent extends Component {
  render() {
    return <View>...</View>
  }
}
```

#### API è°ƒç”¨
```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ AbortController
useEffect(() => {
  const controller = new AbortController()

  const fetchData = async () => {
    const res = await someAPI(controller.signal)
    if (res?.data) {
      // å¤„ç†æ•°æ®
    } else {
      showMsg(res?.msg)
    }
  }
  fetchData()

  return () => controller.abort()
}, [])

// âŒ é”™è¯¯ï¼šæœªå¤„ç†è¯·æ±‚å–æ¶ˆ
useEffect(() => {
  someAPI().then(res => {
    setState(res.data)  // å¯èƒ½åœ¨ç»„ä»¶å¸è½½åæ‰§è¡Œ
  })
}, [])
```

#### æ ·å¼ç¼–å†™
```scss
// ä½¿ç”¨ SCSS åµŒå¥—
.my-component {
  padding: 20px;

  &-header {
    font-size: 32px;
  }

  &-item {
    margin-bottom: 10px;

    &:last-child {
      margin-bottom: 0;
    }
  }
}
```

---

### å‘½åè§„èŒƒ

#### æ–‡ä»¶å‘½å
- é¡µé¢ç»„ä»¶ï¼š`index.tsx`
- é¡µé¢é…ç½®ï¼š`index.config.ts`
- é¡µé¢æ ·å¼ï¼š`index.scss`
- æ™®é€šç»„ä»¶ï¼š`ComponentName/index.tsx`

#### å˜é‡å‘½å
```typescript
// å¸ƒå°”å€¼ï¼šis/has/should å¼€å¤´
const isLoading = true
const hasError = false
const shouldUpdate = true

// æ•°ç»„ï¼šå¤æ•°å½¢å¼
const users = []
const activities = []

// å¯¹è±¡ï¼šå•æ•°å½¢å¼
const user = {}
const activity = {}

// å‡½æ•°ï¼šåŠ¨è¯å¼€å¤´
const getUserInfo = () => {}
const handleClick = () => {}
```

---

### Git æäº¤è§„èŒƒ

ä½¿ç”¨ Commitlint + Husky å¼ºåˆ¶è§„èŒƒï¼š

```bash
# æ ¼å¼
<type>(<scope>): <subject>

# ç¤ºä¾‹
feat(é€šè®¯å½•): æ–°å¢æŒ‰å¹´çº§ç­›é€‰åŠŸèƒ½
fix(ç™»å½•): ä¿®å¤éªŒè¯ç å€’è®¡æ—¶ä¸å‡†ç¡®çš„é—®é¢˜
refactor(API): é‡æ„ç”¨æˆ·æ¥å£æ–‡ä»¶ç»“æ„
docs(README): æ›´æ–°ç¯å¢ƒé…ç½®è¯´æ˜
```

**ç±»å‹ (type)ï¼š**
- `feat` - æ–°åŠŸèƒ½
- `fix` - ä¿®å¤ bug
- `refactor` - é‡æ„ä»£ç 
- `docs` - æ–‡æ¡£æ›´æ–°
- `style` - ä»£ç æ ¼å¼è°ƒæ•´
- `test` - æµ‹è¯•ç›¸å…³
- `chore` - æ„å»º/å·¥å…·é…ç½®

---

## å¸¸è§é—®é¢˜

### 1. ç¼–è¯‘åä¸»åŒ…ä½“ç§¯è¶…è¿‡ 2MB

**åŸå› ï¼š** Webpack åˆ†åŒ…é…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥ `config/index.ts` ä¸­çš„ `splitChunks` é…ç½®
2. ç¡®è®¤ Taroifyã€Vant ç­‰å¤§åº“å·²è¢«è¸¢å‡ºä¸»åŒ…
3. ä½¿ç”¨åˆ†åŒ…å¼‚æ­¥åŒ–ï¼ˆ`subPackages`ï¼‰

---

### 2. 401 è‡ªåŠ¨ç™»å‡ºåæ— é™å¾ªç¯è·³è½¬

**åŸå› ï¼š** ç™»å½•é¡µä¹Ÿå‘èµ·äº†éœ€è¦ token çš„è¯·æ±‚

**è§£å†³æ–¹æ³•ï¼š**
- ç™»å½•é¡µä¸è¦è°ƒç”¨éœ€è¦é‰´æƒçš„ API
- æ£€æŸ¥å…¨å±€ç»„ä»¶æ˜¯å¦åœ¨æœªç™»å½•æ—¶å‘èµ·è¯·æ±‚

---

### 3. TabBar çŠ¶æ€ä¸åŒæ­¥

**åŸå› ï¼š** æœªé€šè¿‡ Redux æ›´æ–° TabBar çŠ¶æ€

**è§£å†³æ–¹æ³•ï¼š**
```typescript
// âŒ é”™è¯¯
Taro.switchTab({ url: '/pages/my/index' })

// âœ… æ­£ç¡®
Taro.switchTab({ url: '/pages/my/index' })
dispatch(setTabBar(2))  // åŒæ­¥æ›´æ–° Redux çŠ¶æ€
```

---

### 4. å¼€å‘ç¯å¢ƒ API è¯·æ±‚å¤±è´¥

**æ£€æŸ¥æ¸…å•ï¼š**
1. `.env.development` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. `TARO_APP_API` æ˜¯å¦é…ç½®æ­£ç¡®
3. åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
4. ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼ˆå¼€å‘ç¯å¢ƒä½¿ç”¨å†…ç½‘åœ°å€ï¼‰

---

### 5. é€šè®¯å½•å­—æ¯é€‰æ‹©å™¨ä¸å‡†ç¡®

**åŸå› ï¼š** `apHeightRef` æˆ– `offsetTopRef` æœªæ­£ç¡®åˆå§‹åŒ–

**è§£å†³æ–¹æ³•ï¼š**
- ç¡®ä¿åœ¨ `useEffect` ä¸­ä½¿ç”¨ `Taro.createSelectorQuery()` è·å–çœŸå®é«˜åº¦
- æ£€æŸ¥ CSS æ ·å¼æ˜¯å¦å½±å“äº†å­—æ¯é¡¹é«˜åº¦

---

### 6. å¾®ä¿¡å°ç¨‹åºçœŸæœºè°ƒè¯•æŠ¥é”™

**å¸¸è§åŸå› ï¼š**
1. **åŸŸåæœªé…ç½®** â†’ åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®æœåŠ¡å™¨åŸŸå
2. **HTTPS è¯ä¹¦é—®é¢˜** â†’ ç¡®ä¿ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æœ‰æ•ˆè¯ä¹¦
3. **API è·¨åŸŸ** â†’ å°ç¨‹åºä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæ£€æŸ¥åç«¯é…ç½®

---

### 7. H5 ç‰ˆæœ¬æ ·å¼é”™ä¹±

**åŸå› ï¼š** å°ç¨‹åºå’Œ H5 çš„æ ·å¼å·®å¼‚

**è§£å†³æ–¹æ³•ï¼š**
```scss
// ä½¿ç”¨æ¡ä»¶ç¼–è¯‘
/* #ifdef H5 */
.my-component {
  padding-top: 44px;  // H5 å¯¼èˆªæ é«˜åº¦
}
/* #endif */

/* #ifdef MP-WEIXIN */
.my-component {
  padding-top: 0;
}
/* #endif */
```

---

### 8. Redux Persist çŠ¶æ€æœªæŒä¹…åŒ–

**åŸå› ï¼š** é¡¹ç›®æœªé…ç½® Redux Persist

**å½“å‰çŠ¶æ€ï¼š** é¡¹ç›®å®‰è£…äº† `redux-persist`ï¼Œä½† `store/index.ts` ä¸­æœªå¯ç”¨

**å¦‚éœ€å¯ç”¨æŒä¹…åŒ–ï¼š**
```typescript
import { persistStore, persistReducer } from 'redux-persist'
import storage from 'redux-persist/lib/storage'

const persistConfig = {
  key: 'root',
  storage,
  whitelist: ['auth']  // åªæŒä¹…åŒ– auth çŠ¶æ€
}

const persistedReducer = persistReducer(persistConfig, rootReducer)
export const store = configureStore({ reducer: persistedReducer })
export const persistor = persistStore(store)
```

---

### 9. Taro.navigateTo è·³è½¬å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
1. **é¡µé¢æœªåœ¨ app.config.ts ä¸­æ³¨å†Œ**
   - æ£€æŸ¥ `pages` æˆ– `subPackages` é…ç½®
2. **è·¯å¾„é”™è¯¯**
   - ä¸»åŒ…é¡µé¢ï¼š`/pages/index/index`
   - åˆ†åŒ…é¡µé¢ï¼š`/loginPkg/pages/login/index`
3. **TabBar é¡µé¢ä½¿ç”¨äº† navigateTo**
   - TabBar é¡µé¢å¿…é¡»ä½¿ç”¨ `Taro.switchTab()`

---

### 10. æ‰“åŒ…åç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ

**åŸå› ï¼š** ç¯å¢ƒå˜é‡æ–‡ä»¶åé”™è¯¯æˆ–å†…å®¹æ ¼å¼ä¸å¯¹

**æ£€æŸ¥æ¸…å•ï¼š**
1. æ–‡ä»¶åå¿…é¡»æ˜¯ `.env.development` æˆ– `.env.production`
2. æ ¼å¼ï¼š`TARO_APP_API="https://..."`ï¼ˆå¿…é¡»æœ‰ `TARO_APP_` å‰ç¼€ï¼‰
3. é‡å¯å¼€å‘æœåŠ¡å™¨

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»é¡¹ç›®è´Ÿè´£äººæˆ–æäº¤ Issueã€‚

---

**æœ€åæ›´æ–°ï¼š** 2026-01-31
